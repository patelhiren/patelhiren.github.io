<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.157.0"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><meta name="description" content="I noticed my OpenClaw gateway log files were growing unbounded. The service runs via launchd, and while the app has built-in log rotation, the stdout/stderr capture in the launchd plist was bypassing it entirely."><title>Using macOS newsyslog to Rotate Service Logs&nbsp;&ndash;&nbsp;Hiren Patel</title><link rel="stylesheet" href="/css/core.min.0b118e14540ca98a7d5831215cbcf668e4d9e6213caec18b7f715a6c1981ff9f8ed2ff5375733a0c71aa1d6ac553f8ff.css" integrity="sha384-CxGOFFQMqYp9WDEhXLz2aOTZ5iE8rsGLf3FabBmB/5&#43;O0v9TdXM6DHGqHWrFU/j/"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Using macOS newsyslog to Rotate Service Logs" /><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" as="style" onload="this.rel='stylesheet'" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
<link rel="manifest" href="/site.webmanifest" />
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#191919" />
<meta name="msapplication-TileColor" content="#00aba9" />
<body><section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><img alt="" loading="lazy" class="site logo" src="/patelhiren-logo.png"/><span class="site name">Hiren Patel</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about/">About</a></nav></div></span></div><div class="site slogan wrap">
            <span class="title left-side">Documenting things as I learn.</span>
            <span class="right-side"><div class="social-buttons">
    <a href="/index.xml" aria-label="Subscribe in your RSS reader">
        <span>
            <i class="fa-solid fa-rss"></i>
        </span>
    </a>
    <a rel="me" href="https://mastodon.social/@patelhiren" target="_blank" aria-label="Follow @patelhiren on Mastodon">
        <span>
            <i class="fa-brands fa-mastodon"></i>
        </span>
    </a>
    <a href="https://twitter.com/patelhiren" target="_blank" aria-label="Follow @patelhiren on Twitter">
        <span>
            <i class="fa-brands fa-twitter"></i>
        </span>
    </a>
</div></span>
        </div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Using macOS newsyslog to Rotate Service Logs</h1><p class="article date">Feb 25, 2026</p></section><article class="article markdown-body"><p>I noticed my <a href="https://clawd.bot/"target="_blank" rel="noopener noreferrer">OpenClaw</a> gateway log files were growing unbounded. The service runs via <a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"target="_blank" rel="noopener noreferrer">launchd</a>, and while the app has built-in log rotation, the stdout/stderr capture in the launchd plist was bypassing it entirely.</p>
<h2 id="the-problem">The Problem</h2>
<p>When a macOS service uses <code>StandardOutPath</code> and <code>StandardErrorPath</code> in its launchd plist, those files just append forever. My logs had grown to 38MB with no mechanism to clean them up:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  3.9M Feb <span class="m">25</span> 17:48 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  38M  Feb <span class="m">25</span> 17:48 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>OpenClaw&rsquo;s internal logger writes date-based rotating logs to <code>/tmp/openclaw/</code>, but launchd&rsquo;s stdout capture writes directly to the configured files, bypassing that rotation logic.</p>
<p><strong>The Hidden Trap:</strong> When log rotation tools like <code>newsyslog</code> create new log files, they default to <code>root:root</code> ownership. If your launchd service runs as your user (not root), it suddenly can&rsquo;t write to its own log files after rotation. The daemon fails to start with &ldquo;Permission denied&rdquo; errors, and you&rsquo;re left wondering why your service won&rsquo;t start.</p>
<h2 id="the-solution-newsyslog">The Solution: newsyslog</h2>
<p>macOS includes <a href="https://www.freebsd.org/cgi/man.cgi?newsyslog%288%29"target="_blank" rel="noopener noreferrer">newsyslog</a>, a utility for managing log file rotation. It&rsquo;s already running on your system, checking logs periodically via launchd. You just need to tell it about your custom log files.</p>
<h3 id="configuration">Configuration</h3>
<p>Create a config file for your service logs:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tee /etc/newsyslog.d/openclaw.conf <span class="s">&lt;&lt; &#39;EOF&#39;
</span></span></span><span class="line"><span class="cl"><span class="s"># OpenClaw gateway logs - rotate at 10MB, keep zero archives
</span></span></span><span class="line"><span class="cl"><span class="s">/Users/clawd/.openclaw/logs/gateway.log    clawd:staff    644  0  10000  *  B
</span></span></span><span class="line"><span class="cl"><span class="s">/Users/clawd/.openclaw/logs/gateway.err.log    clawd:staff    644  0  10000  *  B
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Important:</strong> Notice the <code>clawd:staff</code> owner:group fields. Without these, newsyslog creates the new log files as <code>root:root</code> after rotation. When your launchd service tries to write to a root-owned file, it gets &ldquo;Permission denied&rdquo; and the daemon fails to start.</p>
<p>Field breakdown:</p>
<ul>
<li><code>clawd:staff</code> — Owner and group for the log files (critical!)</li>
<li><code>644</code> — File permissions (owner read/write, others read-only)</li>
<li><code>0</code> — Number of archived files to keep (zero = just truncate)</li>
<li><code>10000</code> — Size threshold in KB (~10MB)</li>
<li><code>*</code> — Rotate at any time (not just specific hours)</li>
<li><code>B</code> — Treat as binary (no special encoding)</li>
</ul>
<h3 id="what-happens-without-owner-specified">What Happens Without Owner Specified</h3>
<p>If you omit the owner:group fields, you&rsquo;ll see this after newsyslog runs:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -la ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> root   wheel     <span class="m">0</span> Feb <span class="m">25</span> 18:30 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> root   wheel     <span class="m">0</span> Feb <span class="m">25</span> 18:30 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then your service fails to start with errors like:</p>
<pre tabindex="0"><code>Could not open log file /Users/clawd/.openclaw/logs/gateway.log: Permission denied
Service exited with abnormal code: 1
</code></pre><p>The <code>clawd:staff</code> fields ensure the rotated files remain owned by your user, not root.</p>
<h3 id="reload-and-verify">Reload and Verify</h3>
<p>Tell newsyslog to reload its configuration:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo killall -HUP newsyslog
</span></span></code></pre></td></tr></table>
</div>
</div><p>Check that the config loaded correctly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo newsyslog -v -f /etc/newsyslog.d/openclaw.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>Force an immediate rotation to test:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo newsyslog -v -f /etc/newsyslog.d/openclaw.conf -R <span class="s2">&#34;manual&#34;</span> ~/.openclaw/logs/gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>Note:</strong> The <code>-R</code> flag with a requestor name is optional. Plain <code>newsyslog -v -f /path/to/config</code> works fine for testing.</p>
</blockquote>
<h2 id="why-not-cron">Why Not Cron?</h2>
<p>I considered a simple cron job:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">0</span> <span class="m">3</span> * * * truncate -s <span class="m">0</span> ~/.openclaw/logs/gateway.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>That would work, but newsyslog is the native macOS tool for this. It&rsquo;s already running, already has permission handling figured out, and rotates based on file size rather than just time. If your log suddenly explodes to 500MB, newsyslog catches it on the next check cycle (every 30 minutes). Cron would wait until 3 AM.</p>
<h2 id="result">Result</h2>
<p>After setup, my 38MB error log was truncated to zero bytes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  4.9M Feb <span class="m">25</span> 18:02 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff   0B  Feb <span class="m">25</span> 18:10 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>No manual intervention needed going forward. When either file crosses 10MB, newsyslog truncates it automatically.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://www.freebsd.org/cgi/man.cgi?newsyslog%288%29"target="_blank" rel="noopener noreferrer">newsyslog man page</a></li>
<li><a href="https://docs.openclaw.ai/"target="_blank" rel="noopener noreferrer">OpenClaw documentation</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"target="_blank" rel="noopener noreferrer">launchd documentation</a></li>
</ul></article><section class="article labels"><a class="category" href=/categories/how-tos/>How Tos</a><a class="category" href=/categories/programming/>Programming</a><a class="tag" href=/tags/macos/>macOS</a><a class="tag" href=/tags/logging/>logging</a><a class="tag" href=/tags/launchd/>launchd</a><a class="tag" href=/tags/newsyslog/>newsyslog</a><a class="tag" href=/tags/openclaw/>openclaw</a></section>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/blog/tag-teaming-claude-code-with-ai-agent/"><span class="iconfont icon-article"></span>Tag-Teaming Claude Code with an AI Agent via Tmux</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">© Copyright 2026, © Copyright {year}, Hiren Patel</p>
    <p class="disclaimer">Disclaimer: The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</p>
</div></section>
    
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
        data-cf-beacon='{"token": "0ceb2b0172264816ba290291f3b99e4f"}'></script>
    
</body>

</html>