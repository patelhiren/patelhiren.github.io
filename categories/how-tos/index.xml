<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>How Tos on Hiren Patel</title><link>https://patelhiren.com/categories/how-tos/</link><description>Recent content in How Tos on Hiren Patel</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>© Copyright {year}, Hiren Patel</copyright><lastBuildDate>Wed, 25 Feb 2026 00:00:00 +0000</lastBuildDate><atom:link href="https://patelhiren.com/categories/how-tos/index.xml" rel="self" type="application/rss+xml"/><item><title>Using macOS newsyslog to Rotate Service Logs</title><link>https://patelhiren.com/blog/macos-newsyslog-openclaw-logs/</link><pubDate>Wed, 25 Feb 2026 00:00:00 +0000</pubDate><guid>https://patelhiren.com/blog/macos-newsyslog-openclaw-logs/</guid><description>&lt;p&gt;I noticed my &lt;a href="https://clawd.bot/"target="_blank" rel="noopener noreferrer"&gt;OpenClaw&lt;/a&gt; gateway log files were growing unbounded. The service runs via &lt;a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"target="_blank" rel="noopener noreferrer"&gt;launchd&lt;/a&gt;, and while the app has built-in log rotation, the stdout/stderr capture in the launchd plist was bypassing it entirely.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I noticed my <a href="https://clawd.bot/"target="_blank" rel="noopener noreferrer">OpenClaw</a> gateway log files were growing unbounded. The service runs via <a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"target="_blank" rel="noopener noreferrer">launchd</a>, and while the app has built-in log rotation, the stdout/stderr capture in the launchd plist was bypassing it entirely.</p>
<h2 id="the-problem">The Problem</h2>
<p>When a macOS service uses <code>StandardOutPath</code> and <code>StandardErrorPath</code> in its launchd plist, those files just append forever. My logs had grown to 38MB with no mechanism to clean them up:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  3.9M Feb <span class="m">25</span> 17:48 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  38M  Feb <span class="m">25</span> 17:48 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>OpenClaw&rsquo;s internal logger writes date-based rotating logs to <code>/tmp/openclaw/</code>, but launchd&rsquo;s stdout capture writes directly to the configured files, bypassing that rotation logic.</p>
<p><strong>The Hidden Trap:</strong> When log rotation tools like <code>newsyslog</code> create new log files, they default to <code>root:root</code> ownership. If your launchd service runs as your user (not root), it suddenly can&rsquo;t write to its own log files after rotation. The daemon fails to start with &ldquo;Permission denied&rdquo; errors, and you&rsquo;re left wondering why your service won&rsquo;t start.</p>
<h2 id="the-solution-newsyslog">The Solution: newsyslog</h2>
<p>macOS includes <a href="https://www.freebsd.org/cgi/man.cgi?newsyslog%288%29"target="_blank" rel="noopener noreferrer">newsyslog</a>, a utility for managing log file rotation. It&rsquo;s already running on your system, checking logs periodically via launchd. You just need to tell it about your custom log files.</p>
<h3 id="configuration">Configuration</h3>
<p>Create a config file for your service logs:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo tee /etc/newsyslog.d/openclaw.conf <span class="s">&lt;&lt; &#39;EOF&#39;
</span></span></span><span class="line"><span class="cl"><span class="s"># OpenClaw gateway logs - rotate at 10MB, keep zero archives
</span></span></span><span class="line"><span class="cl"><span class="s">/Users/clawd/.openclaw/logs/gateway.log    clawd:staff    644  0  10000  *  B
</span></span></span><span class="line"><span class="cl"><span class="s">/Users/clawd/.openclaw/logs/gateway.err.log    clawd:staff    644  0  10000  *  B
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Important:</strong> Notice the <code>clawd:staff</code> owner:group fields. Without these, newsyslog creates the new log files as <code>root:root</code> after rotation. When your launchd service tries to write to a root-owned file, it gets &ldquo;Permission denied&rdquo; and the daemon fails to start.</p>
<p>Field breakdown:</p>
<ul>
<li><code>clawd:staff</code> — Owner and group for the log files (critical!)</li>
<li><code>644</code> — File permissions (owner read/write, others read-only)</li>
<li><code>0</code> — Number of archived files to keep (zero = just truncate)</li>
<li><code>10000</code> — Size threshold in KB (~10MB)</li>
<li><code>*</code> — Rotate at any time (not just specific hours)</li>
<li><code>B</code> — Treat as binary (no special encoding)</li>
</ul>
<h3 id="what-happens-without-owner-specified">What Happens Without Owner Specified</h3>
<p>If you omit the owner:group fields, you&rsquo;ll see this after newsyslog runs:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -la ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> root   wheel     <span class="m">0</span> Feb <span class="m">25</span> 18:30 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> root   wheel     <span class="m">0</span> Feb <span class="m">25</span> 18:30 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then your service fails to start with errors like:</p>
<pre tabindex="0"><code>Could not open log file /Users/clawd/.openclaw/logs/gateway.log: Permission denied
Service exited with abnormal code: 1
</code></pre><p>The <code>clawd:staff</code> fields ensure the rotated files remain owned by your user, not root.</p>
<h3 id="reload-and-verify">Reload and Verify</h3>
<p>Tell newsyslog to reload its configuration:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo killall -HUP newsyslog
</span></span></code></pre></td></tr></table>
</div>
</div><p>Check that the config loaded correctly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo newsyslog -v -f /etc/newsyslog.d/openclaw.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>Force an immediate rotation to test:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo newsyslog -v -f /etc/newsyslog.d/openclaw.conf -R <span class="s2">&#34;manual&#34;</span> ~/.openclaw/logs/gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>Note:</strong> The <code>-R</code> flag with a requestor name is optional. Plain <code>newsyslog -v -f /path/to/config</code> works fine for testing.</p>
</blockquote>
<h2 id="why-not-cron">Why Not Cron?</h2>
<p>I considered a simple cron job:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">0</span> <span class="m">3</span> * * * truncate -s <span class="m">0</span> ~/.openclaw/logs/gateway.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>That would work, but newsyslog is the native macOS tool for this. It&rsquo;s already running, already has permission handling figured out, and rotates based on file size rather than just time. If your log suddenly explodes to 500MB, newsyslog catches it on the next check cycle (every 30 minutes). Cron would wait until 3 AM.</p>
<h2 id="result">Result</h2>
<p>After setup, my 38MB error log was truncated to zero bytes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ls -lh ~/.openclaw/logs/
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff  4.9M Feb <span class="m">25</span> 18:02 gateway.log
</span></span><span class="line"><span class="cl">-rw-r--r--  <span class="m">1</span> clawd  staff   0B  Feb <span class="m">25</span> 18:10 gateway.err.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>No manual intervention needed going forward. When either file crosses 10MB, newsyslog truncates it automatically.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://www.freebsd.org/cgi/man.cgi?newsyslog%288%29"target="_blank" rel="noopener noreferrer">newsyslog man page</a></li>
<li><a href="https://docs.openclaw.ai/"target="_blank" rel="noopener noreferrer">OpenClaw documentation</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html"target="_blank" rel="noopener noreferrer">launchd documentation</a></li>
</ul>]]></content:encoded></item><item><title>Deploying a Sandboxed Family Agent with Cross-Compiled Go Skills in Clawdbot</title><link>https://patelhiren.com/blog/deploying-sandboxed-family-agent-clawdbot/</link><pubDate>Mon, 19 Jan 2026 00:00:00 +0000</pubDate><guid>https://patelhiren.com/blog/deploying-sandboxed-family-agent-clawdbot/</guid><description>&lt;p&gt;I wanted to set up a &amp;ldquo;Family Agent&amp;rdquo; in &lt;a href="https://clawd.bot/"target="_blank" rel="noopener noreferrer"&gt;Clawdbot&lt;/a&gt; so my family could interact with tools like stock analysis and summarization via WhatsApp. However, I needed to ensure this agent was completely isolated from my personal credentials and host system. Here is how I configured a sandboxed environment and deployed cross-compiled &lt;a href="https://go.dev/"target="_blank" rel="noopener noreferrer"&gt;Go&lt;/a&gt; skills to solve this.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I wanted to set up a &ldquo;Family Agent&rdquo; in <a href="https://clawd.bot/"target="_blank" rel="noopener noreferrer">Clawdbot</a> so my family could interact with tools like stock analysis and summarization via WhatsApp. However, I needed to ensure this agent was completely isolated from my personal credentials and host system. Here is how I configured a sandboxed environment and deployed cross-compiled <a href="https://go.dev/"target="_blank" rel="noopener noreferrer">Go</a> skills to solve this.</p>
<h2 id="customizing-the-sandbox-image">Customizing the Sandbox Image</h2>
<p>Because some skills have specific runtime requirements—like the <code>summarize</code> skill needing Node.js 20+ to support newer regular expression flags—I created a custom <a href="https://www.docker.com/"target="_blank" rel="noopener noreferrer">Docker</a> image. Using a default image with Node.js v18 resulted in a <code>SyntaxError</code> when the tool&rsquo;s dependencies tried to load, so &ldquo;baking in&rdquo; the correct runtime was the first step.</p>
<h3 id="the-dockerfile">The Dockerfile</h3>
<p>I used a <code>node:20-slim</code> base to ensure all modern Node dependencies were supported:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">node:20-slim</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="c"># Install system dependencies</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> apt-get update <span class="o">&amp;&amp;</span> apt-get install -y <span class="se">\
</span></span></span><span class="line"><span class="cl">    curl <span class="se">\
</span></span></span><span class="line"><span class="cl">    ca-certificates <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Building the image is a one-time task:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t <span class="o">[</span>YOUR_DOCKER_IMAGE<span class="o">]</span>:1.0 .
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cross-compiling-go-binaries-for-multi-platform-support">Cross-Compiling Go Binaries for Multi-Platform Support</h2>
<p>To keep the agent high-performance, I wrote my custom skills (like <code>stock-analysis</code>) in Go. The beauty of Go is the ability to test locally on my M1 Max (<code>darwin/arm64</code>) and then cross-compile for the sandboxed Linux environment.</p>
<p>By producing a single binary for each platform and placing them in the <code>dist/</code> folder of the skill, the agent can run the correct version regardless of the environment.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Build for macOS (Local Testing)</span>
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>darwin <span class="nv">GOARCH</span><span class="o">=</span>arm64 go build -o dist/stock-analysis main.go
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Build for Linux (Sandbox Deployment)</span>
</span></span><span class="line"><span class="cl"><span class="nv">GOOS</span><span class="o">=</span>linux <span class="nv">GOARCH</span><span class="o">=</span>arm64 go build -o dist/stock-analysis-linux main.go
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bridging-the-llm-and-code-with-skillmd">Bridging the LLM and Code with <code>SKILL.md</code></h2>
<p>Clawdbot uses a <code>SKILL.md</code> file to discover these binaries and understand how to use them. This file acts as the bridge between the LLM’s natural language and the Go code. For the stock analysis tool, I defined mandatory rules to ensure the agent returns the raw <code>stdout</code> verbatim, which is critical for trading data fidelity.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">### Command
</span></span></span><span class="line"><span class="cl"><span class="gh"># macOS / Darwin
</span></span></span><span class="line"><span class="cl">stock-analysis &lt;TICKER&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># Linux / Sandbox
</span></span></span><span class="line"><span class="cl">stock-analysis-linux &lt;TICKER&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="configuring-the-agent-and-docker-sandbox">Configuring the Agent and Docker Sandbox</h2>
<p>With the image built and skills compiled, I defined the <code>family</code> agent in <code>clawdbot.json</code>. Setting the sandbox mode to <code>all</code> forces every tool execution into the Docker container.</p>
<p>Crucially, because skills like <code>summarize</code> and <code>stock-analysis</code> need to reach out to external APIs and websites, I had to explicitly grant the sandbox internet access by setting the Docker network to <code>bridge</code> mode.</p>
<h3 id="the-agent-json-structure">The Agent JSON Structure</h3>
<p>The <code>env</code> block and <code>sandbox</code> settings live directly within the agent&rsquo;s definition. Here is the full structure for the <code>family</code> agent:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;family&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;family&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;env&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;ANTHROPIC_API_KEY&#34;</span><span class="p">:</span> <span class="s2">&#34;{{auth:[YOUR_ANTHROPIC_PROFILE]}}&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;GEMINI_API_KEY&#34;</span><span class="p">:</span> <span class="s2">&#34;{{auth:[YOUR_GEMINI_PROFILE]}}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;workspace&#34;</span><span class="p">:</span> <span class="s2">&#34;[WORKSPACE_PATH]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;sandbox&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;mode&#34;</span><span class="p">:</span> <span class="s2">&#34;all&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;workspaceAccess&#34;</span><span class="p">:</span> <span class="s2">&#34;rw&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;scope&#34;</span><span class="p">:</span> <span class="s2">&#34;agent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;docker&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;image&#34;</span><span class="p">:</span> <span class="s2">&#34;[YOUR_DOCKER_IMAGE]:1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;network&#34;</span><span class="p">:</span> <span class="s2">&#34;bridge&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;tools&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;sandbox&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;tools&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;allow&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;exec&#34;</span><span class="p">,</span> <span class="s2">&#34;bash&#34;</span><span class="p">,</span> <span class="s2">&#34;read&#34;</span><span class="p">,</span> <span class="s2">&#34;write&#34;</span><span class="p">,</span> <span class="s2">&#34;summarize&#34;</span><span class="p">,</span> <span class="s2">&#34;stock-analysis&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I then bound this agent to a specific WhatsApp group ID so it only responds to family requests:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;bindings&#34;</span><span class="err">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;agentId&#34;</span><span class="p">:</span> <span class="s2">&#34;family&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;match&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;channel&#34;</span><span class="p">:</span> <span class="s2">&#34;whatsapp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;peer&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;kind&#34;</span><span class="p">:</span> <span class="s2">&#34;group&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;[YOUR_GROUP_ID]@g.us&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="lessons-learned">Lessons Learned</h2>
<h3 id="1-secure-credential-injection">1. Secure Credential Injection</h3>
<p>A key security feature of the sandbox is that it starts with a clean slate. By checking the sandbox logs, I could see that tools were failing because they lacked API keys. To fix this, I used explicit environment mapping in the JSON config.</p>
<p>You must map the <strong>specific environment variables</strong> that your skills expect (like <code>GEMINI_API_KEY</code> or <code>ANTHROPIC_API_KEY</code>) to your secure Clawdbot authentication profiles inside the <code>env</code> block shown in the configuration section above.</p>
<p>This ensures the agent is &ldquo;least privileged&rdquo;—it only has the specific tokens it needs to run its assigned skills.</p>
<h2 id="pro-tip-refreshing-the-sandbox">Pro-Tip: Refreshing the Sandbox</h2>
<p>Clawdbot creates the Docker container for the agent only one time. It persists across restarts for speed. If you need to force a clean slate or pick up changes in your custom image, simply delete the running container:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker rm -f <span class="o">[</span>CONTAINER_ID<span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Clawdbot will automatically recreate the container from the image on the next request.</p>
<h2 id="wrapping-up">Wrapping Up</h2>
<p>By using Docker for isolation, enabling bridge networking for internet access, and cross-compiling Go binaries for both macOS and Linux, I’ve created a setup that is both high-performance and secure. This configuration allows my family to benefit from agentic workflows while maintaining strict control over credential access and runtime environments.</p>]]></content:encoded></item><item><title>Upgrading Portainer Community Edition on Docker</title><link>https://patelhiren.com/blog/upgrading-portainer-ce-on-docker/</link><pubDate>Sun, 19 Feb 2023 12:18:21 -0500</pubDate><guid>https://patelhiren.com/blog/upgrading-portainer-ce-on-docker/</guid><description>&lt;p&gt;I run a docker instance under Ubuntu server on my local network. This is how I upgrade portainer to the latest version.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I run a docker instance under Ubuntu server on my local network. This is how I upgrade portainer to the latest version.</p>
<p>Connect to the Ubuntu server via SSH and run the below commands.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># Stop portainer</span>
</span></span><span class="line"><span class="cl">sudo docker stop portainer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Remove existing container</span>
</span></span><span class="line"><span class="cl">sudo docker rm portainer
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Pull the latest portainer-ce image</span>
</span></span><span class="line"><span class="cl">sudo docker pull portainer/portainer-ce:latest
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create and start portainer using the latest image.</span>
</span></span><span class="line"><span class="cl">sudo docker run -d -p 8000:8000 -p 9000:9000 --name<span class="o">=</span>portainer --restart<span class="o">=</span>always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest
</span></span></code></pre></td></tr></table>
</div>
</div><p>This will upgrade portainer to the latest version. It should again be accessible at <code>http://&lt;&lt;server&gt;&gt;:9000</code>.</p>]]></content:encoded></item><item><title>Setting up Keras Tensorflow2 on M1 Mac</title><link>https://patelhiren.com/blog/setting-up-keras-tensorflow2-on-m1-mac/</link><pubDate>Fri, 21 Oct 2022 13:32:11 -0400</pubDate><guid>https://patelhiren.com/blog/setting-up-keras-tensorflow2-on-m1-mac/</guid><description>&lt;p&gt;I am currently reading &lt;a href="https://www.amazon.com/gp/product/B0B18D695W"target="_blank" rel="noopener noreferrer"&gt;Deep Learning with TensorFlow and Keras&lt;/a&gt; to get started with Machine Learning/Deep Learning. Here is how I setup a local &lt;em&gt;Keras/Tensorflow 2.0&lt;/em&gt; environment on my &lt;em&gt;M1 Max MacBook Pro&lt;/em&gt; running &lt;em&gt;macOS 12.6&lt;/em&gt;.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I am currently reading <a href="https://www.amazon.com/gp/product/B0B18D695W"target="_blank" rel="noopener noreferrer">Deep Learning with TensorFlow and Keras</a> to get started with Machine Learning/Deep Learning. Here is how I setup a local <em>Keras/Tensorflow 2.0</em> environment on my <em>M1 Max MacBook Pro</em> running <em>macOS 12.6</em>.</p>
<p>Install <a href="https://docs.conda.io/en/latest/miniconda.html"target="_blank" rel="noopener noreferrer"><em>miniconda</em></a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">brew install --cask miniconda
</span></span></code></pre></td></tr></table>
</div>
</div><p>I use zsh with <a href="https://iterm2.com"target="_blank" rel="noopener noreferrer">iTerm2</a> as my terminal so I need to initialize conda with the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">conda init zsh
</span></span></code></pre></td></tr></table>
</div>
</div><p>This will make it so everytime iTerm2 is opened, the conda <em>base</em> environment will be activated. I prefer to activate my environment manually, so I did the below to deactivate the base environment on launch of iTerm2.</p>
<p>In <code>~/.zshrc</code> add the following section after the <code># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</code> line.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># Deactivate base conda environment. You can activate an environment using conda activate &lt;&lt;environment-name&gt;&gt;</span>
</span></span><span class="line"><span class="cl">conda deactivate
</span></span></code></pre></td></tr></table>
</div>
</div><p>We now create an environment named <em>tensorflow</em> where we could run our ML/DL Keras training.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">conda create -n tensorflow <span class="nv">python</span><span class="o">=</span>3.9
</span></span></code></pre></td></tr></table>
</div>
</div><p>We then switch to the <em>tensorflow</em> environment and install dependencies.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># Activate tensorflow environment</span>
</span></span><span class="line"><span class="cl">conda activate tensorflow
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install apple tensorflow dependencies</span>
</span></span><span class="line"><span class="cl">conda install -c apple tensorflow-deps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install tensorflow macos</span>
</span></span><span class="line"><span class="cl">python -m pip install tensorflow-macos
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install tensorflow metal plugin</span>
</span></span><span class="line"><span class="cl">python -m pip install tensorflow-metal
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install tensorflow readymade datasets</span>
</span></span><span class="line"><span class="cl">python -m pip install tensorflow-datasets
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install libjpeg (needed by mathplotlib)</span>
</span></span><span class="line"><span class="cl">brew install libjpeg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install mathplotlib and jupyterlab</span>
</span></span><span class="line"><span class="cl">conda install -y matplotlib jupyterlab
</span></span></code></pre></td></tr></table>
</div>
</div><p>This may not be necessary for future installs. But I ran into an error with numpy when trying to run my notebook code.</p>
<blockquote>
<p><em><strong>module compiled against API version 0x10 but this version of numpy is 0xf</strong></em></p>
</blockquote>
<p>To correct this I had to run this command in my <em>tensorflow</em> environment.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">python -m pip install numpy --upgrade
</span></span></code></pre></td></tr></table>
</div>
</div><p>Another warning I ran into.</p>
<blockquote>
<p><em><strong>TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See <a href="https://ipywidgets.readthedocs.io/en/stable/user_install.html"target="_blank" rel="noopener noreferrer">https://ipywidgets.readthedocs.io/en/stable/user_install.html</a> from .autonotebook import tqdm as notebook_tqdm</strong></em></p>
</blockquote>
<p>To resolve I ran the below in my <em>tensorflow</em> environment.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">python -m pip install ipywidgets widgetsnbextension pandas-profiling
</span></span></code></pre></td></tr></table>
</div>
</div><p>You may now run <code>jupyter notebook</code> command from the <em>tensorflow</em> environment to start the jupyter notebook environment from the command line. I however prefer using <a href="https://code.visualstudio.com/"target="_blank" rel="noopener noreferrer">Visual Studio Code</a> and start an environment under vscode as documented below.</p>
<ul>
<li>Install the <code>Jupyter</code> extension under vscode.</li>
<li>Load the <em>Command Pallet</em> using (<code>Cmd+Shift+P</code>) and select <code>Jupyter: Select Interpreter to Start Jupyter Server</code> and then select <code>Python 3.9.13 ('tensorflow')</code> or whatever environment you want to use.</li>
<li>Load the <em>Command Pallet</em> using (<code>Cmd+Shift+P</code>) and select <code>Create: New Jupyter Notebook</code></li>
<li>You may now run all the Jupyter notebook in vscode. When run the code cell, vscode will start the jupyter server if it is not already started in the selected environment.</li>
</ul>
<h3 id="code">Code</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;TensorFlow has access to the following devices:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;* </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="output">Output</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">TensorFlow has access to the following devices:
</span></span><span class="line"><span class="cl">* PhysicalDevice(name=&#39;/physical_device:CPU:0&#39;, device_type=&#39;CPU&#39;)
</span></span><span class="line"><span class="cl">* PhysicalDevice(name=&#39;/physical_device:GPU:0&#39;, device_type=&#39;GPU&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded></item><item><title>Setting Visual Studio Code as default text editor on macOS</title><link>https://patelhiren.com/blog/setting-vscode-as-default-text-editor-on-macos/</link><pubDate>Tue, 23 Mar 2021 22:29:29 -0400</pubDate><guid>https://patelhiren.com/blog/setting-vscode-as-default-text-editor-on-macos/</guid><description>&lt;p&gt;&lt;a href="https://code.visualstudio.com"target="_blank" rel="noopener noreferrer"&gt;Visual Studio Code&lt;/a&gt; is quite capable has become my editor of choice on macOS. Here is how to set it as the default text editor instead of &lt;em&gt;Text Edit&lt;/em&gt;.&lt;/p&gt;</description><content:encoded><![CDATA[<p><a href="https://code.visualstudio.com"target="_blank" rel="noopener noreferrer">Visual Studio Code</a> is quite capable has become my editor of choice on macOS. Here is how to set it as the default text editor instead of <em>Text Edit</em>.</p>
<p>Install <a href="https://github.com/moretension/duti"target="_blank" rel="noopener noreferrer">duti</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">brew install duti
</span></span></code></pre></td></tr></table>
</div>
</div><p>Set <em>Visual Studio Code</em> as the default editor for all text files and public files by running the below commands using <em>duti</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># Mark vscode as default editor for all text files</span>
</span></span><span class="line"><span class="cl">duti -s com.microsoft.VSCode public.plain-text all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Some files without extensions are considered public.data and not public.text. Set those to open in vscode as well</span>
</span></span><span class="line"><span class="cl">duti -s com.microsoft.VSCode public.data all
</span></span></code></pre></td></tr></table>
</div>
</div><p>The changes should take effect right away and no reboot or relaunch of <em>Finder</em> should be needed.</p>]]></content:encoded></item><item><title>macOS and Active Directory Passwords</title><link>https://patelhiren.com/blog/macos-and-active-directory-passwords/</link><pubDate>Sat, 02 Jan 2021 17:30:27 -0500</pubDate><guid>https://patelhiren.com/blog/macos-and-active-directory-passwords/</guid><description>&lt;p&gt;Macs connected to Active Directory routinely need to update passwords. When working remote, Active Directory password change is not exactly easy. Here are the steps I follow to update my Active Directory password and keep my local mac password in sync.&lt;/p&gt;</description><content:encoded><![CDATA[<p>Macs connected to Active Directory routinely need to update passwords. When working remote, Active Directory password change is not exactly easy. Here are the steps I follow to update my Active Directory password and keep my local mac password in sync.</p>
<p>Connect to corporate VPN so that Active Directory is reachable over VPN. Open Terminal and run the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">kpasswd myusername@FULLADDOMAIN.COM
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">myusername@FULLADDOMAIN.COM&#39;s Password: 
</span></span></span><span class="line"><span class="cl"><span class="go">New password for myusername@FULLADDOMAIN.COM: 
</span></span></span><span class="line"><span class="cl"><span class="go">Verify password - New password for myusername@FULLADDOMAIN.COM: 
</span></span></span><span class="line"><span class="cl"><span class="go">Success
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Once password change is confirmed, run the following to force sync the updated password to keychain.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">dsconfigad -passinterval <span class="m">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Wait about a minute, log out and log back in. You should be logging in with the new password. If login still requires the old password the password sync with active directory did not happen yet. Log back in with the old password, connect to VPN (You will need to use your new password when connecting to VPN) and run the <code>dsconfigad -passinterval 0</code> command and wait a mintue or so before trying to log out/login.</p>
<p>The process once finished will make sure your local keychain password and AD passwords are in sync.</p>]]></content:encoded></item><item><title>Cross Compiling on macOS via Docker</title><link>https://patelhiren.com/blog/cross-compiling-on-macos-via-docker/</link><pubDate>Wed, 23 Dec 2020 09:31:48 -0500</pubDate><guid>https://patelhiren.com/blog/cross-compiling-on-macos-via-docker/</guid><description>&lt;p&gt;I needed to compile an arm64 binary to run on the &lt;a href="https://store.ui.com/collections/unifi-network-routing-switching/products/udm-pro"target="_blank" rel="noopener noreferrer"&gt;UniFi Dream Machine Pro&lt;/a&gt;. This is how I used docker to setup cross compilation tools and compile the binary on macOS.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I needed to compile an arm64 binary to run on the <a href="https://store.ui.com/collections/unifi-network-routing-switching/products/udm-pro"target="_blank" rel="noopener noreferrer">UniFi Dream Machine Pro</a>. This is how I used docker to setup cross compilation tools and compile the binary on macOS.</p>
<p>Get and install <a href="https://docs.docker.com/docker-for-mac/install/"target="_blank" rel="noopener noreferrer">Docker Desktop</a> is not already installed. Once installed we can use <a href="https://github.com/dockcross/dockcross"target="_blank" rel="noopener noreferrer">DockCross</a> to setup an cross compile tool chain we want. Here is an example of how I setup the linux-arm64 toolchain.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">mkdir -p ~/Documents/dockcross
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~/Documents/dockcross
</span></span><span class="line"><span class="cl">docker run --rm dockcross/linux-arm64 &gt; ./dockcross-linux-arm64
</span></span><span class="line"><span class="cl">chmod +x ./dockcross-linux-arm64
</span></span></code></pre></td></tr></table>
</div>
</div><p>This will setup a linux-arm64 cross compiler. To compile files using this compiler you have to place the files in the same directory as the binary. Here is an exaple of how to compile.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">./dockcross-linux-arm64 bash <span class="se">\
</span></span></span><span class="line"><span class="cl">-c <span class="s1">&#39;$CC -s -O3 main.c -o ./udp-broadcast-relay-redux&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Examining the compiled binary with <em>file</em> command should display <em>ARM aarch64</em> architecture.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">file udp-broadcast-relay-redux
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">udp-broadcast-relay-redux: ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), 
</span></span></span><span class="line"><span class="cl"><span class="go">dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, for GNU/Linux 4.10.8, stripped
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>Note:</strong> Using <em>$CC</em> is important. If you use <em>gcc</em> directly it will compile using <em>x86_64</em> version.</p>
</blockquote>]]></content:encoded></item><item><title>Domain Specific DNS Servers on macOS</title><link>https://patelhiren.com/blog/domain-specific-dns-servers-on-macos/</link><pubDate>Fri, 22 May 2020 14:36:00 -0400</pubDate><guid>https://patelhiren.com/blog/domain-specific-dns-servers-on-macos/</guid><description>&lt;p&gt;My work has multiple domains (&lt;code&gt;corp.network&lt;/code&gt; and &lt;code&gt;lab.network&lt;/code&gt;) that the nameservers resolve. When in the office the resolution works perfectly. However while conncting over VPN via Tunnelblick the resolution to lab.network was failing.&lt;/p&gt;</description><content:encoded><![CDATA[<p>My work has multiple domains (<code>corp.network</code> and <code>lab.network</code>) that the nameservers resolve. When in the office the resolution works perfectly. However while conncting over VPN via Tunnelblick the resolution to lab.network was failing.</p>
<p>I could go into my System Preferences-&gt;Network Settings and modify my wifi interface settings to enter a new DNS value for those specific domains. But that felt tedious. Instead I used the below method to specify custom DNS resolver settings for my work domains.</p>
<p>Under <code>/etc/resolver</code> create a file with a name of your choice. I chose <code>corp.netowrk</code> just for clarity.</p>
<p>Here is an example of what the contents could be.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="na">domain corp.network</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 10.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 10.0.0.2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>I could create another file for the lab network with a different dns server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="na">domain lab.network</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 10.0.1.1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The above would make it so any lookup to <code>xxx.corp.network</code> would use the specified nameserver at <code>10.0.0.1</code> and <code>10.0.0.2</code>.
If I try to access <code>devserver.lab.network</code> it would ask the nameserver at <code>10.0.1.1</code> for its IP.</p>
<p>You could take it a step further and provide backup lookup settings. For example you may have a server located at <code>demo.corp.com</code> that resolves different IPs based on if you are connected to VPN or not. So <code>demo.corp.com</code> should be resolved via VPN nameservers when you are connected to VPN, but via ISP name servers when not connected to VPN. To achive this you could create two files under <code>/etc/resolver</code> like so.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="na">domain corp.com</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 10.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 10.0.0.2</span>
</span></span><span class="line"><span class="cl"><span class="na">search_order 1</span>
</span></span><span class="line"><span class="cl"><span class="na">timeout 5</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cfg" data-lang="cfg"><span class="line"><span class="cl"><span class="na">domain corp.com</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 1.1.1.1</span>
</span></span><span class="line"><span class="cl"><span class="na">nameserver 1.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="na">search_order 2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The above two files make it so the macOS DNS resolver will first try to use the VPN domains for resolution. If we dont get a response withing 5 seconds, it will fallback to the second file and use <a href="https://1.1.1.1/dns/"target="_blank" rel="noopener noreferrer">Cloudflare DNS</a> to do an internet lookup of the IP address.</p>]]></content:encoded></item><item><title>Using Tunnelblick to Connect to WatchGuard VPN</title><link>https://patelhiren.com/blog/using-tunnelblick-to-connect-to-watchguard-vpn/</link><pubDate>Sun, 26 Apr 2020 12:55:50 -0400</pubDate><guid>https://patelhiren.com/blog/using-tunnelblick-to-connect-to-watchguard-vpn/</guid><description>&lt;p&gt;I needed to connect to a corporate VPN that used &lt;a href="https://www.watchguard.com"target="_blank" rel="noopener noreferrer"&gt;WatchGuard&lt;/a&gt;. The IT provided &lt;em&gt;Mobile VPN with SSL Client&lt;/em&gt; software did not work reliably on macOS Catalina. It sometimes show connected but unable to access remote vpn resources.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I needed to connect to a corporate VPN that used <a href="https://www.watchguard.com"target="_blank" rel="noopener noreferrer">WatchGuard</a>. The IT provided <em>Mobile VPN with SSL Client</em> software did not work reliably on macOS Catalina. It sometimes show connected but unable to access remote vpn resources.</p>
<p>I discovered that the <em>WatchGuard</em> VPN internally is an OpenVPN server. I use <a href="https://tunnelblick.net"target="_blank" rel="noopener noreferrer">Tunnelblick</a> for my personal OpenVPN connections and that has worked reliably on macOS Catalina. So if I just had the connection <em>ovpn</em> config file I could use <em>Tunnelblick</em> for my VPN connections.</p>
<p>WatchGuard has a detailed support document that walks the user through downloading their software to use for VPN connection at <a href="https://www.watchguard.com/help/docs/fireware/12/en-US/Content/en-US/mvpn/ssl/mvpn_ssl_client-install_c.html"target="_blank" rel="noopener noreferrer">https://www.watchguard.com/help/docs/fireware/12/en-US/Content/en-US/mvpn/ssl/mvpn_ssl_client-install_c.html</a>.</p>
<p>Turns out that page also provides an option to download the <em>ovpn</em> config that can be used with <em>Tunnelblick</em>.</p>
<h2 id="acquiring-the-ovpn-config">Acquiring the OVPN config</h2>
<ul>
<li>Browse to <code>https://&lt;yourvpnserverip:port&gt;/sslvpn.html</code>. You will be greeted with a login page.</li>
</ul>
<p>

<span class="image-container">
    <span class="link">
        <a target="_blank" rel="noopener noreferrer" href="images/01.jpg">
            <picture><source 
                    srcset="
                    
                    /blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/01_hu_5205600a052ec080.jpg 400w,
                    
                    
                    

                    

                    

                    /blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/01.jpg
                    " 
                />
                
                <img alt="WatchGuard - Login Page" 
                        src="/blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/01.jpg" />
            </picture>
        </a>
    </span>
    <span class="caption">
        <span class="title">WatchGuard - Login Page</span>
    </span>
</span></a></p>
<ul>
<li>Login using your corporate credentials.</li>
<li>You will be offered a download page.</li>
</ul>
<p>

<span class="image-container">
    <span class="link">
        <a target="_blank" rel="noopener noreferrer" href="images/02.jpg">
            <picture><source 
                    srcset="
                    
                    /blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/02_hu_2beb8b39f5863ef7.jpg 400w,
                    
                    
                    

                    

                    

                    /blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/02.jpg
                    " 
                />
                
                <img alt="WatchGuard - Download Page" 
                        src="/blog/using-tunnelblick-to-connect-to-watchguard-vpn/images/02.jpg" />
            </picture>
        </a>
    </span>
    <span class="caption">
        <span class="title">WatchGuard - Download Page</span>
    </span>
</span></a></p>
<ul>
<li>Select the <strong><em>Download</em></strong> option under <em>Mobile VPN with SSL client profile</em>.</li>
<li>This will offer a <em>client.ovpn</em> file that you can import into <em>Tunnelblick</em> for connection to your corporate network.</li>
</ul>
<p>The page offer options to download the Mobile VPN with SSL Client software for Mac and Windows as well if you want those.</p>]]></content:encoded></item><item><title>Building this website using open-source tools and hosting it for free</title><link>https://patelhiren.com/blog/website-built-with-open-source-and-hosted-for-free/</link><pubDate>Sat, 18 Apr 2020 16:08:20 -0400</pubDate><guid>https://patelhiren.com/blog/website-built-with-open-source-and-hosted-for-free/</guid><description>&lt;p&gt;For a while, I have been considering building a website to document things I learn. This year I decided to stop procsanating and get started with it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Introducing &lt;a href="https://patelhiren.com"title="Hiren Patel&amp;#39;s Blog"target="_blank" rel="noopener noreferrer"&gt;patelhiren.com&lt;/a&gt; in all its glory. &amp;#x1f389;&lt;/strong&gt;&lt;/p&gt;</description><content:encoded><![CDATA[<p>For a while, I have been considering building a website to document things I learn. This year I decided to stop procsanating and get started with it.</p>
<p><strong>Introducing <a href="https://patelhiren.com"title="Hiren Patel&#39;s Blog"target="_blank" rel="noopener noreferrer">patelhiren.com</a> in all its glory. &#x1f389;</strong></p>
<h2 id="goals">Goals</h2>
<p>For this site I had a few basic goals in mind.</p>
<ul>
<li>It should serve as a log to help me remember and reivew how I did things. I hope that others may find it helpful as well.</li>
<li>The website should be fast and light. Should not be overburdened with Javascript.</li>
<li>Should be able to host website with a simple webserver. No server side software should be necessary.</li>
<li>Allowed me to keep my content in a standard text + image format for easy parsing even when not viewing via a browser. I did not want my content to be stored in binary formats in a database. I want it to be stored in plain text files on the filesystem.</li>
<li>Support code syntax highlighting.</li>
<li>Support SSL encryption on the website.</li>
<li>Support emoji.</li>
</ul>
<p>The above goals meant I was going to be building a Static Site using one of the many <a href="https://www.staticgen.com"target="_blank" rel="noopener noreferrer">Static Site Generator Tools</a></p>
<h2 id="tools">Tools</h2>
<p>After deciding I wanted a static site, I researched the various <a href="https://www.staticgen.com"target="_blank" rel="noopener noreferrer">Static Site Generator Tools</a> and settled on <a href="https://gohugo.io"target="_blank" rel="noopener noreferrer"><em>Hugo</em></a> as my choice.</p>
<p>Hugo written in <a href="https://golang.org"target="_blank" rel="noopener noreferrer">Go</a>, is highly reviewed and praised for its speed of site generation. It supports macOS (my primary OS of choice), Windows, Linux, OpenBSD and FreeBSD. It has a very well documented site and looks to have an active community developing and supporting it. It allows me to create my content in <a href="https://daringfireball.net/projects/markdown/"target="_blank" rel="noopener noreferrer">Markdown</a> syntax thus allowing me to keep it in plain text on the filesystem. It also supports code syntax highlighting and emoji &#x1f44c;. You can check details of Hugo&rsquo;s Makrdown support at <a href="https://www.markdownguide.org/tools/hugo/"target="_blank" rel="noopener noreferrer">markdownguide.org</a></p>
<p>Hugo supports a variety of <a href="https://themes.gohugo.io"target="_blank" rel="noopener noreferrer">Themes</a>. I settled on <a href="https://themes.gohugo.io/hugo-notepadium/"target="_blank" rel="noopener noreferrer">Notepadium</a> because it provided most of what I wanted out of box. I plan to customize it a bit to my liking as I learn more.</p>
<h2 id="hosting">Hosting</h2>
<p>For hosting I decided to use <a href="https://pages.github.com"target="_blank" rel="noopener noreferrer">GitHub Pages</a>. GitHub Pages is free, supports SSL and provides automatic CDN for serving fast webpages closer to your user. It also had the added benefit of having my generated site auotmatically have commit history and remote backup.</p>
<h2 id="installing-hugo-and-building-your-site">Installing Hugo and Building your site</h2>
<p>I use macOS as my primary OS so these steps are for for the Mac. However the steps should be very similar if you are using any other supported OS. <a href="https://brew.sh"target="_blank" rel="noopener noreferrer">Homebrew</a> and <em>git</em> <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> is expected to be installed before you follow the rest of the steps.</p>
<p>Install Hugo</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">brew install hugo
</span></span></code></pre></td></tr></table>
</div>
</div><p>To verify the install run</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo version
</span></span></code></pre></td></tr></table>
</div>
</div><p>Create your new site</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo new site patelhiren.com
</span></span></code></pre></td></tr></table>
</div>
</div><p>Add the <em><a href="https://themes.gohugo.io/hugo-notepadium/"target="_blank" rel="noopener noreferrer">Notepadium</a></em> Theme</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="nb">cd</span> patelhiren.com
</span></span><span class="line"><span class="cl">git init
</span></span><span class="line"><span class="cl">git submodule add https://github.com/cntrump/hugo-notepadium themes/notepadium
</span></span></code></pre></td></tr></table>
</div>
</div><p>Activate the theme for your site by adding it to the <em>config.toml</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;theme = &#34;notepadium&#34;&#39;</span> &gt;&gt; config.toml
</span></span></code></pre></td></tr></table>
</div>
</div><p>Create a new post <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo new blog/my-first-post/index.md
</span></span></code></pre></td></tr></table>
</div>
</div><p>You can find your content under <em>content</em> folder. You can open the newly created index.md file in any Markdown editor of choice <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> and edit and save your content. Here is an example post to suggest what&rsquo;s possible.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">title: &#34;My First Post&#34;
</span></span><span class="line"><span class="cl">description: &#34;This is my first post in Hugo. This shows up in Google search.&#34;
</span></span><span class="line"><span class="cl">date: 2020-04-18T16:08:20-04:00
</span></span><span class="line"><span class="cl">draft: true
</span></span><span class="line"><span class="cl">tags: [
</span></span><span class="line"><span class="cl">    &#34;Tag 1&#34;,
</span></span><span class="line"><span class="cl">    &#34;Tag 2&#34;
</span></span><span class="line"><span class="cl">]
</span></span><span class="line"><span class="cl">categories: [
</span></span><span class="line"><span class="cl">    &#34;Category 1&#34;,
</span></span><span class="line"><span class="cl">    &#34;Category 2&#34;
</span></span><span class="line"><span class="cl">]
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hello everyone welcome to you website.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;!--more--&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This is the extended content of my first post.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once you save your content you can test it locally by activating Hugo local web server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo server -D
</span></span></code></pre></td></tr></table>
</div>
</div><p>You can navigate to your local site at <a href="http://localhost:1313/"target="_blank" rel="noopener noreferrer">http://localhost:1313/</a>.</p>
<p>Edit you <em>config.toml</em> to configure the rest of your site settings. Here is mine.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">baseURL</span> <span class="p">=</span> <span class="s2">&#34;https://patelhiren.com/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">languageCode</span> <span class="p">=</span> <span class="s2">&#34;en-us&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;Hiren Patel&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">theme</span> <span class="p">=</span> <span class="s2">&#34;notepadium&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">copyright</span> <span class="p">=</span> <span class="s2">&#34;©2020 Hiren Patel.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableEmoji</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableRobotsTXT</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">highlight</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">codeFences</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="nx">noClasses</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="nx">linenos</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">goldmark</span><span class="p">.</span><span class="nx">renderer</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">unsafe</span> <span class="p">=</span> <span class="kc">true</span>  <span class="c"># enable raw HTML in Markdown</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">style</span> <span class="p">=</span> <span class="s2">&#34;auto&#34;</span>  <span class="c"># default: auto. light: light theme, dark: dark theme, auto: based on system.</span>
</span></span><span class="line"><span class="cl"><span class="nx">dateFormat</span> <span class="p">=</span> <span class="s2">&#34;Jan 02, 2006&#34;</span>  <span class="c"># if unset, default is &#34;2006-01-02&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">readingTime</span> <span class="p">=</span> <span class="kc">false</span>  <span class="c"># show reading time after article date</span>
</span></span><span class="line"><span class="cl"><span class="nx">logo</span> <span class="p">=</span> <span class="s2">&#34;patelhiren-logo.png&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">slogan</span> <span class="p">=</span> <span class="s2">&#34;Documenting things as I learn.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">assets</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">css</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;css/fonts.css&#34;</span><span class="p">,</span> <span class="s2">&#34;css/light.css&#34;</span><span class="p">,</span> <span class="s2">&#34;css/dark.css&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">comments</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>  <span class="c"># En/Disable comments globally, default: false. You can always enable comments on per page.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">share</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>  <span class="c"># En/Disable share globally, default: false. You can always enable share on per page.</span>
</span></span><span class="line"><span class="cl"><span class="nx">addThisId</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">inlineToolId</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">math</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span> <span class="c"># load math globally, default: false. You can always enable math on per page.</span>
</span></span><span class="line"><span class="cl"><span class="nx">use</span> <span class="p">=</span> <span class="s2">&#34;katex&#34;</span>  <span class="c"># builtin: &#34;katex&#34;, &#34;mathjax&#34;.  default: &#34;katex&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">syntax</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">use</span> <span class="p">=</span> <span class="s2">&#34;none&#34;</span>  <span class="c"># builtin: &#34;prismjs&#34;, &#34;hljs&#34;. &#34;none&#34; means Chroma</span>
</span></span><span class="line"><span class="cl"><span class="nx">theme</span> <span class="p">=</span> <span class="s2">&#34;xcode&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">darkTheme</span> <span class="p">=</span> <span class="s2">&#34;xcode-dark&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">nav</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">showCategories</span> <span class="p">=</span> <span class="kc">true</span>       <span class="c"># /categories/</span>
</span></span><span class="line"><span class="cl"><span class="nx">showTags</span> <span class="p">=</span> <span class="kc">true</span>             <span class="c"># /tags/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>To build your static site run:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo -D
</span></span></code></pre></td></tr></table>
</div>
</div><p>The output will be saved under <em>./public/</em> directory. You may copy the contents of this folder to any webserver and your website will be servered.</p>
<h2 id="hosting-your-site-on-github-pages">Hosting your site on GitHub Pages</h2>
<ul>
<li>Create a repository to hold your Hugo content and source files on GitHub. Mine is called <em>patelhiren.com</em></li>
<li>Create a repository called <em>&lt;username&gt;.github.io</em>. Replace <em>&lt;username&gt;</em> with your GitHub username. Mine is called patelhiren.github.io.</li>
<li>Clone your source project via:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># adjust to match your git url.</span>
</span></span><span class="line"><span class="cl">git clone git@github.com:patelhiren/patelhiren.com.git
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Paste your existing source files in the new repository folder.</p>
</li>
<li>
<p>Run and verify your local Hugo files from local repo by running <code>hugo server -D</code> and accessing the site at <a href="http://localhost:1313/"target="_blank" rel="noopener noreferrer">http://localhost:1313/</a>.</p>
</li>
<li>
<p>Once you are happy with the results:</p>
<ul>
<li>Press Ctrl+C to kill the server</li>
<li>Before proceeding completely remove the public directory</li>
</ul>
</li>
<li>
<p>Add your public site as a git submodule. Like so:</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="c1"># adjust to match your GitHub Pages repo</span>
</span></span><span class="line"><span class="cl">git submodule add -b master git@github.com:patelhiren/patelhiren.github.io.git
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="automating-the-deployment-process">Automating the deployment process</h3>
<p>Create a new file <code>deploy.sh</code> and set its contents to below script. This will allow you to run <code>deploy.sh</code> to build your site and deploy to GitHub in one go.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If a command fails then the deploy stops</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -e
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="s2">&#34;\033[0;32mDeploying updates to GitHub...\033[0m\n&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Go To Public folder</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Discard local changes on public folder</span>
</span></span><span class="line"><span class="cl">git reset
</span></span><span class="line"><span class="cl">git checkout .
</span></span><span class="line"><span class="cl">git clean -fdx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Pull the latest changes before updating</span>
</span></span><span class="line"><span class="cl">git checkout master
</span></span><span class="line"><span class="cl">git pull origin master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Garbage collect hugo image-processing generated images.</span>
</span></span><span class="line"><span class="cl">hugo --gc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Build the project.</span>
</span></span><span class="line"><span class="cl">hugo <span class="c1"># if using a theme, replace with `hugo -t &lt;YOURTHEME&gt;`</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Go To Public folder</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add changes to git.</span>
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Commit changes.</span>
</span></span><span class="line"><span class="cl"><span class="nv">msg</span><span class="o">=</span><span class="s2">&#34;rebuilding site </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$*</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nv">msg</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$*</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;</span><span class="nv">$msg</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Push source and build repos.</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Your site will then be available at <code>https://&lt;username&gt;.github.io</code>.</li>
</ul>
<h2 id="customizing-github-pages-to-use-a-custom-domain">Customizing GitHub pages to use a custom domain</h2>
<p>If you plan to use your own doamin instead of the &lt;username&gt;.github.io you need to follow the guide at <a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site"target="_blank" rel="noopener noreferrer">Managing a custom domain for your GitHub Pages site</a>.</p>
<p>For my site I did the following:</p>
<ul>
<li>Create a file called <code>CNAME</code> and set its contents to <em>patelhiren.com</em>.</li>
<li>Added the <code>CNAME</code> file to the git repo at patelhiren.github.io.</li>
<li>Got to Repo Settings at <a href="https://github.com/patelhiren/patelhiren.github.io/settings"target="_blank" rel="noopener noreferrer">https://github.com/patelhiren/patelhiren.github.io/settings</a> and set <strong>Custom domain</strong> and <strong>Enforce HTTPS</strong> settings.</li>
</ul>
<p>

<span class="image-container">
    <span class="link">
        <a target="_blank" rel="noopener noreferrer" href="images/01.png">
            <picture><source 
                    srcset="
                    
                    /blog/website-built-with-open-source-and-hosted-for-free/images/01_hu_f8cf2a96e93b4973.png 400w,
                    
                    
                    
                    /blog/website-built-with-open-source-and-hosted-for-free/images/01_hu_4383a184a6f2d4d0.png 600w,
                    

                    
                    /blog/website-built-with-open-source-and-hosted-for-free/images/01_hu_ad528813d2f7789d.png 1000w,
                    

                    
                    /blog/website-built-with-open-source-and-hosted-for-free/images/01_hu_94bdcf91d0ad626f.png 1200w,
                    

                    /blog/website-built-with-open-source-and-hosted-for-free/images/01.png
                    " 
                />
                
                <img alt="GitHub Pages Custom Domain Settings" 
                        src="/blog/website-built-with-open-source-and-hosted-for-free/images/01.png" />
            </picture>
        </a>
    </span>
    <span class="caption">
        <span class="title">GitHub Pages Custom Subdomain Settings</span>
    </span>
</span></a></p>
<h2 id="publishing-new-postchanges">Publishing new Post/Changes</h2>
<p>To publish a new post:</p>
<ul>
<li>Create a new post similar to to command below.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">hugo new blog/my-new-post/index.md
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Set and edit your post using Markdown tools.</p>
</li>
<li>
<p>Run and verify your local Hugo files from local repo by running <code>hugo server -D</code> and accessing the site at <a href="http://localhost:1313/"target="_blank" rel="noopener noreferrer">http://localhost:1313/</a>.</p>
</li>
<li>
<p>Run <code>deploy.sh</code> to deploy your site.</p>
</li>
<li>
<p>Commit your changes to your source repo.</p>
</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>This is all that should be necessary. It looks like a lot of steps, but in practice it is very simple and doesn&rsquo;t require as much work to maintain for publishing new posts.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>For a git GUI, I prefer <a href="https://www.git-fork.com"target="_blank" rel="noopener noreferrer">Fork</a>.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Creating a blog post this way with a folder as the post name allows you to keep images within the same folder instead of keeping images in the root folder. This felt like better grouping of content vs the default Hugo suggested way of generating new post via <em>hugo new blog/my-first-post</em>.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>I prefer <a href="https://code.visualstudio.com"target="_blank" rel="noopener noreferrer">Visual Studio Code</a>. Tip: If using Visual Studio Code you can press <em>CMD+K,V</em> to activate side-by-side live preview of the Markdown you are typing.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>]]></content:encoded></item><item><title>Boot Camp on External Drive</title><link>https://patelhiren.com/blog/boot-camp-on-external-drive/</link><pubDate>Mon, 06 Apr 2020 14:02:10 -0400</pubDate><guid>https://patelhiren.com/blog/boot-camp-on-external-drive/</guid><description>&lt;p&gt;I had a spare SSD and a USB enclosure for it. Installing windows on an external drive is unsupported by Microsoft and the setup will abort stating Windows cannot be installed on an external drive. Here is how I managed to install Windows 10 Pro on the external SSD and boot from it on my iMac.&lt;/p&gt;</description><content:encoded><![CDATA[<p>I had a spare SSD and a USB enclosure for it. Installing windows on an external drive is unsupported by Microsoft and the setup will abort stating Windows cannot be installed on an external drive. Here is how I managed to install Windows 10 Pro on the external SSD and boot from it on my iMac.</p>
<h6 id="my-environment">My Environment</h6>
<ul>
<li>27-inch iMac 2019, running macOS Catalina 10.15.4</li>
<li>120 GB ScanDisk Plus SSD</li>
<li>2.5-inch SATA USB enclosure</li>
</ul>
<h6 id="software-needed">Software needed</h6>
<ul>
<li>VMware Fusion 11.5.3 (Trial is fine)</li>
<li>Windows 10 ISO</li>
</ul>
<h6 id="directions">Directions</h6>
<ul>
<li>Launch Disk Utility and select the plugged in SSD. Format as below


<span class="image-container">
    <span class="link">
        <a target="_blank" rel="noopener noreferrer" href="images/01.png">
            <picture>

                    <source 
                        srcset="
                        
                        /blog/boot-camp-on-external-drive/images/Dark/01_hu_37e776f44f118384.png 400w,
                        
                        
                        
                        /blog/boot-camp-on-external-drive/images/Dark/01_hu_5a4b76fb68f6a377.png 600w,
                        

                        
                        /blog/boot-camp-on-external-drive/images/Dark/01_hu_a8f4274529767127.png 1000w,
                        

                        
                        /blog/boot-camp-on-external-drive/images/Dark/01_hu_1562304620a92662.png 1200w,
                        

                        /blog/boot-camp-on-external-drive/images/Dark/01.png
                        "
                        media="(prefers-color-scheme: dark)"
                    /><source 
                    srcset="
                    
                    /blog/boot-camp-on-external-drive/images/01_hu_888c9a07e5bcf836.png 400w,
                    
                    
                    
                    /blog/boot-camp-on-external-drive/images/01_hu_c97268cb491cf8ca.png 600w,
                    

                    
                    /blog/boot-camp-on-external-drive/images/01_hu_21da07b6bce4d901.png 1000w,
                    

                    
                    /blog/boot-camp-on-external-drive/images/01_hu_15d32e45bb516e1b.png 1200w,
                    

                    /blog/boot-camp-on-external-drive/images/01.png
                    " 
                />
                
                <img alt="DiskUtility - Format Disk Settings" 
                        src="/blog/boot-camp-on-external-drive/images/01.png" />
            </picture>
        </a>
    </span>
    <span class="caption">
        <span class="title">Disk Utility - Format Disk</span>
    </span>
</span></a></li>
<li>Make a note of the Disk Id. In my case it was <code>disk5</code></li>
<li>Create a new Windows 10 Virtual Machine under VMware Fusion.</li>
<li>Delete the default Disk the VMware Fusion creates when setting up the machine.</li>
<li>Exit VMware Fusion and launch Terminal and run the following command. Adjust the Virtual Manchine path as needed.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zsh" data-lang="zsh"><span class="line"><span class="cl">/Applications/VMware<span class="se">\ </span>Fusion.app/Contents/Library/vmware-rawdiskCreator <span class="se">\
</span></span></span><span class="line"><span class="cl">create /dev/disk5 <span class="se">\
</span></span></span><span class="line"><span class="cl">fullDevice ~/Virtual<span class="se">\ </span>Machines.localized/Boot<span class="se">\ </span>Camp.vmwarevm/external-hdd <span class="se">\
</span></span></span><span class="line"><span class="cl">ide
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Open <code>Boot Camp.vmx</code> file in a text editor like Visual Studio Code and add the below lines.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="cl"><span class="na">ide1:0.present</span> <span class="o">=</span> <span class="s">&#34;TRUE&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">ide1:0.fileName</span> <span class="o">=</span> <span class="s">&#34;external-hdd.vmdk&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>If you are running macOS Catalina you will need to give <code>Full Disk Access</code> Permissions to <code>com.vmware.DiskHelper</code>. If you do not see it in the list. Try to start the Virtual Machine. You will get an error starting after which the item will show up in the list.


<span class="image-container">
    <span class="link">
        <a target="_blank" rel="noopener noreferrer" href="images/02.png">
            <picture>

                    <source 
                        srcset="
                        
                        /blog/boot-camp-on-external-drive/images/Dark/02_hu_3d4b9e33a300de7f.png 400w,
                        
                        
                        
                        /blog/boot-camp-on-external-drive/images/Dark/02_hu_6059e001e0261bf0.png 600w,
                        

                        
                        /blog/boot-camp-on-external-drive/images/Dark/02_hu_8703ca8095b07d80.png 1000w,
                        

                        
                        /blog/boot-camp-on-external-drive/images/Dark/02_hu_e080a15a5fd63eda.png 1200w,
                        

                        /blog/boot-camp-on-external-drive/images/Dark/02.png
                        "
                        media="(prefers-color-scheme: dark)"
                    /><source 
                    srcset="
                    
                    /blog/boot-camp-on-external-drive/images/02_hu_8fe245289a05c4c3.png 400w,
                    
                    
                    
                    /blog/boot-camp-on-external-drive/images/02_hu_53845f4c0e8885cb.png 600w,
                    

                    
                    /blog/boot-camp-on-external-drive/images/02_hu_a9258d80a3d399b9.png 1000w,
                    

                    
                    /blog/boot-camp-on-external-drive/images/02_hu_8190eeffba24d043.png 1200w,
                    

                    /blog/boot-camp-on-external-drive/images/02.png
                    " 
                />
                
                <img alt="Security &amp; Privacy - Full Disk Access" 
                        src="/blog/boot-camp-on-external-drive/images/02.png" />
            </picture>
        </a>
    </span>
    <span class="caption">
        <span class="title">Security & Privacy - Full Disk Access</span>
    </span>
</span></a></li>
<li>Quit and Restart VMWare fusion. Start the Boot Camp vm. You will be prompted for you admin password.</li>
<li>Once the VM starts boot off the Windows 10 ISO and install Windows 10 on the attached disk. Delete all partitions on the disk during install and let windows create new partitions as needed.</li>
<li>Once the install is fully finished, install VMware Tools to help facilitate copying of files.</li>
<li>On the Mac launch <code>Boot Camp Assistant.app</code>. From the <code>Action</code> menu select <code>Download Windows Support Software</code>. Follow the steps to get the Boot Camp windows drivers.</li>
<li>Copy the Drivers to the Windows machine. Shutdown the VM.</li>
<li>You may now reboot into the windows partition by rebooting the Mac and holding down the Option key during boot.</li>
<li>After Windows boots up, you will have to install the Boot Camp drivers by launching BootCamp setup from the <code>WindowsSupport\BootCamp\Setup.exe</code> folder.</li>
</ul>
<h6 id="additional-steps">Additional Steps</h6>
<ul>
<li>After installation of the Boot Camp drivers and reboot, Windows still had a few missing drivers under Device Manager. All I had to do was select <code>Update Driver</code> and select the <code>WindowsSupport\$WinPEDriver$</code> folder to look for drivers.</li>
<li>Speakers were not working properly on the 2019 iMac even though all drivers were installed. I had to go to <code>Device Manager</code>-&gt;<code>Sound, video and game controllers</code>-&gt;<code>High Definition Audio Device</code>. Select Update driver and point it to <code>WindowsSupport\$WinPEDriver$\Cirrus</code>. This installed the correct drivers and the Speakers started working.</li>
<li>Another speed bump I ran into was that after a few Windows updates were applied windows declined to update to the November 2019 update stating installing Windows on External USB is unsupported. &#x1f612; I had to go to the Registry at <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control</code> and set the <code>PortableOperatingSystem</code> value to <code>0</code> and reboot. After that the update installed ok. &#x1f60f;</li>
</ul>]]></content:encoded></item></channel></rss>