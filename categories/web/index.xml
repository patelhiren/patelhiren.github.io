<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Web on Hiren Patel</title>
    <link>https://patelhiren.com/categories/web/</link>
    <description>Recent content in Web on Hiren Patel</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Â©2020 Hiren Patel.</copyright>
    <lastBuildDate>Sun, 12 Apr 2020 22:04:30 -0400</lastBuildDate>
    
	<atom:link href="https://patelhiren.com/categories/web/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>PNG Crush Automator Action</title>
      <link>https://patelhiren.com/blog/pngcrush-automator-action/</link>
      <pubDate>Sun, 12 Apr 2020 22:04:30 -0400</pubDate>
      
      <guid>https://patelhiren.com/blog/pngcrush-automator-action/</guid>
      <description>&lt;p&gt;When using png files on the web it is often preferred to use tools like pngcrush on them to optimize their size. This is usually a manual process where a command line tool or website is used to process each image file. I decided to automate this process for me via macOS &lt;a href=&#34;https://support.apple.com/guide/automator/welcome/mac&#34;target=&#34;_blank&#34;&gt;Automator&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To crush png images I use the opensource tool &lt;a href=&#34;https://pmt.sourceforge.io/pngcrush/&#34;target=&#34;_blank&#34;&gt;PNG Crush&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you have &lt;a href=&#34;https://developer.apple.com/xcode/&#34;target=&#34;_blank&#34;&gt;Xcode&lt;/a&gt; installed, the pngcrush tool is included as a part of the iOS SDK and there is no additional download required.&lt;/p&gt;
&lt;p&gt;If you do not have Xcode you may install &lt;em&gt;PNG Crush&lt;/em&gt; via &lt;a href=&#34;https://brew.sh&#34;target=&#34;_blank&#34;&gt;Homebrew&lt;/a&gt; using the following command.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;brew install pngcrush
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;If using Xcode method, the &lt;em&gt;&lt;strong&gt;pngcrush&lt;/strong&gt;&lt;/em&gt; binary will be at &lt;code&gt;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/pngcrush&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If using Homebrew, the &lt;em&gt;&lt;strong&gt;pngcrush&lt;/strong&gt;&lt;/em&gt; binary will be at &lt;code&gt;/usr/local/bin/pngcrush&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;For the rest of the article I will assume the Homebrew method is used. You just need to adjust the paths for the binary if the Xcode method is used.&lt;/p&gt;
&lt;p&gt;To crush a PNG image via Terminal you can run the below command.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# pngcrush will process the input.png and create a compressed crushed.png&lt;/span&gt;
pngcrush input.png crushed.png
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;automating-the-process-using-automator-on-macos&#34;&gt;Automating the process using Automator on macOS.&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Launch &lt;em&gt;&lt;strong&gt;Automator&lt;/strong&gt;&lt;/em&gt; via Spotlight Search.&lt;/li&gt;
&lt;li&gt;Select &lt;em&gt;File&lt;/em&gt;, &lt;em&gt;New&lt;/em&gt; from the menu. Select &lt;em&gt;&lt;strong&gt;Quick Action&lt;/strong&gt;&lt;/em&gt; and click the &lt;em&gt;Choose&lt;/em&gt; button.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/01-Light.png&#34;&gt;&lt;img  src=&#34;images/01-Light.png&#34;
        alt=&#34;Automator - New&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In the new windows that loads, select the options as below.
&lt;ul&gt;
&lt;li&gt;Workflow receives current - &lt;em&gt;&lt;strong&gt;image files&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;in - &lt;em&gt;&lt;strong&gt;Finder.app&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/02-Light.png&#34;&gt;&lt;img  src=&#34;images/02-Light.png&#34;
        alt=&#34;Automator - New Action&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;In the search box, type &lt;em&gt;&lt;strong&gt;Shell&lt;/strong&gt;&lt;/em&gt; and select the &lt;em&gt;&lt;strong&gt;Run Shell Script&lt;/strong&gt;&lt;/em&gt; option to add to the automation on the right by double clicking on it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/03-Light.png&#34;&gt;&lt;img  src=&#34;images/03-Light.png&#34;
        alt=&#34;Automator - Run Shell Script&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Change the &lt;em&gt;&lt;strong&gt;Pass Input&lt;/strong&gt;&lt;/em&gt; option to &lt;em&gt;&lt;strong&gt;as arguments&lt;/strong&gt;&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Enter the below script commands in the Shell Script box.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; f in &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$@&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# Verify that the extension of the file is actually png&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# (case insensitive compare)&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;basename &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nv&#34;&gt;ext&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;##*.&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$ext&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep -i png&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# If the file is a png, run pngcrush on it.&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# Save the output in the same place with a temporary extension&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# of .crushed_&lt;/span&gt;
		/usr/local/bin/pngcrush &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.crushed_&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;# Overwrite the original file with the crushed file.&lt;/span&gt;
		mv &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.crushed_&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Save the automation as &lt;em&gt;&lt;strong&gt;PNG Crush&lt;/strong&gt;&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/04-Light.png&#34;&gt;&lt;img  src=&#34;images/04-Light.png&#34;
        alt=&#34;Automator - Final Code&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;You may now browse to any png file(s) in Finder and right click, select &lt;em&gt;&lt;strong&gt;Services&lt;/strong&gt;&lt;/em&gt; -&amp;gt; &lt;em&gt;&lt;strong&gt;PNG Crush&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/05-Light.png&#34;&gt;&lt;img  src=&#34;images/05-Light.png&#34;
        alt=&#34;Finder - Services Menu&#34;/&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;While the automation is running you will see a spinning cog in you Menu bar in the top right. When the cog disappears the automation is done and your images have been processed by &lt;em&gt;&lt;strong&gt;pngcrush&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; 
  href=&#34;images/06-Light.png&#34;&gt;&lt;img  src=&#34;images/06-Light.png&#34;
        alt=&#34;Finder - Automator Running&#34;/&gt;&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>